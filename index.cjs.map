{"version":3,"file":"index.cjs","sources":["index.mjs"],"sourcesContent":["/* eslint-disable no-unused-vars */\n\nimport { readFileSync, existsSync, writeFileSync } from 'fs'\nimport path from 'path'\nimport { fileURLToPath } from 'url'\nimport esbuild from 'esbuild'\nconst { resolve, join } = path\nconst __dirname = path.dirname(new URL(import.meta.url).pathname)\n\n/**\n * @typedef {import('esbuild').BuildOptions} BuildOptions\n */\n\n/**\n * @param {{\n *   esbuild?: (defaultOptions: BuildOptions) => Promise<BuildOptions> | BuildOptions;\n * }} [options]\n **/\nexport default function (options) {\n  /** @type {import('@sveltejs/kit').Adapter} */\n  const adapter = {\n    name: '@sveltejs/adapter-begin',\n\n    async adapt ({ utils }) {\n      const files = fileURLToPath(new URL('./files', import.meta.url))\n      utils.log.minor('verifying app.arc manifest exists')\n      if (!existsSync('app.arc')) {\n        utils.log.minor('adding architect manifest app.arc')\n        utils.copy(join(files, 'app.arc'), 'app.arc')\n      }\n\n      utils.log.minor('bundling server for lambda...')\n      utils.copy(join(files, 'entry.js'), '.svelte-kit/begin/entry.js')\n\n      /** @type {BuildOptions} */\n      const defaultOptions = {\n        entryPoints: ['.svelte-kit/begin/entry.js'],\n        outfile: join('.begin', 'sveltekit-render', 'index.js'),\n        bundle: true,\n        inject: [join(files, 'shims.js')],\n        platform: 'node'\n      }\n\n      const buildOptions = options && options.esbuild\n        ? await options.esbuild(defaultOptions)\n        : defaultOptions\n\n      await esbuild.build(buildOptions)\n\n      const staticDirectory = resolve('.begin', 'public')\n\n      utils.log.minor('Writing client application...')\n      utils.copy_static_files(staticDirectory)\n      utils.copy_client_files(staticDirectory)\n\n      utils.log.minor('Prerendering static pages...')\n      await utils.prerender({\n        dest: staticDirectory\n      })\n    }\n  }\n\n  return adapter\n}\n"],"names":["path","fileURLToPath","existsSync","esbuild"],"mappings":";;;;;;;;;;;;;;AAAA;AAMA,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAGA,yBAAI;AACZA,wBAAI,CAAC,OAAO,CAAC,IAAI,GAAG,CAAC,oMAAe,CAAC,CAAC,QAAQ,EAAC;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,cAAQ,EAAE,OAAO,EAAE;AAClC;AACA,EAAE,MAAM,OAAO,GAAG;AAClB,IAAI,IAAI,EAAE,yBAAyB;AACnC;AACA,IAAI,MAAM,KAAK,CAAC,CAAC,EAAE,KAAK,EAAE,EAAE;AAC5B,MAAM,MAAM,KAAK,GAAGC,iBAAa,CAAC,IAAI,GAAG,CAAC,SAAS,EAAE,oMAAe,CAAC,EAAC;AACtE,MAAM,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,mCAAmC,EAAC;AAC1D,MAAM,IAAI,CAACC,aAAU,CAAC,SAAS,CAAC,EAAE;AAClC,QAAQ,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,mCAAmC,EAAC;AAC5D,QAAQ,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,SAAS,CAAC,EAAE,SAAS,EAAC;AACrD,OAAO;AACP;AACA,MAAM,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,+BAA+B,EAAC;AACtD,MAAM,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,UAAU,CAAC,EAAE,4BAA4B,EAAC;AACvE;AACA;AACA,MAAM,MAAM,cAAc,GAAG;AAC7B,QAAQ,WAAW,EAAE,CAAC,4BAA4B,CAAC;AACnD,QAAQ,OAAO,EAAE,IAAI,CAAC,QAAQ,EAAE,kBAAkB,EAAE,UAAU,CAAC;AAC/D,QAAQ,MAAM,EAAE,IAAI;AACpB,QAAQ,MAAM,EAAE,CAAC,IAAI,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;AACzC,QAAQ,QAAQ,EAAE,MAAM;AACxB,QAAO;AACP;AACA,MAAM,MAAM,YAAY,GAAG,OAAO,IAAI,OAAO,CAAC,OAAO;AACrD,UAAU,MAAM,OAAO,CAAC,OAAO,CAAC,cAAc,CAAC;AAC/C,UAAU,eAAc;AACxB;AACA,MAAM,MAAMC,2BAAO,CAAC,KAAK,CAAC,YAAY,EAAC;AACvC;AACA,MAAM,MAAM,eAAe,GAAG,OAAO,CAAC,QAAQ,EAAE,QAAQ,EAAC;AACzD;AACA,MAAM,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,+BAA+B,EAAC;AACtD,MAAM,KAAK,CAAC,iBAAiB,CAAC,eAAe,EAAC;AAC9C,MAAM,KAAK,CAAC,iBAAiB,CAAC,eAAe,EAAC;AAC9C;AACA,MAAM,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,8BAA8B,EAAC;AACrD,MAAM,MAAM,KAAK,CAAC,SAAS,CAAC;AAC5B,QAAQ,IAAI,EAAE,eAAe;AAC7B,OAAO,EAAC;AACR,KAAK;AACL,IAAG;AACH;AACA,EAAE,OAAO,OAAO;AAChB;;;;"}